
#!/bin/bash

# based off of https://github.com/FilipLitwora/dotfiles/blob/master/.local/bin/wallpaper -powwu

#find random wallpaper or if specified and set it as wallpaper using pywal

export dpi=$(cat /home/james/.dpi)

dir="$1"

function apply_wallpaper {
	if [ -d "$1" ] # if directory
    		then
        		ls $1 |sort -R |tail -1 |while read file; do
               dir=$dir/$file
	        	   apply_wallpaper $dir # recursive so it goes down directories completely
        		done
  else # if file 
  	 wal -i $1
     feh --bg-fill $1
     echo "$1" > $HOME/.current-wallpaper
	fi
}

if [ -z "$1" ] 
then
    echo "usage: $0 [path/to/images] or [path/to/image]"
    exit 1
else
    apply_wallpaper $1
fi


cp $HOME/.cache/wal/colors.Xresources $HOME/.Xresources
echo "Xft.dpi: $dpi" >> $HOME/.Xresources
pywalfox update
python ~/.local/bin/alacritty_xr_color_scheme ~/.config/alacritty/alacritty.yml
spicetify update
pywal-discord
xrdb -merge $HOME/.Xresources
#sleep 1
i3-msg restart && i3-msg restart # gotta do it twice or else it hangs sometimes... :(

#https://github.com/FilipLitwora/pywal-discord
#pywal-discord 


#spicetify update

#reload bspwm border colors

#bspc config normal_border_color "${foreground}"
#bspc config focused_border_color "${color2}"
#color=$(sed 's/\#//' <<< $background)
#echo $color
#ratbagctl "Logitech G403 Prodigy Wired/Wireless Gaming Mouse" led 0 set color $color

#ratbagctl "Logitech G403 Prodigy Wired/Wireless Gaming Mouse" led 1 set color $color
